{"ast":null,"code":"var _jsxFileName = \"D:\\\\lum3k\\\\Desktop\\\\vkApp\\\\src\\\\App.js\";\nimport React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport { View } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport fetchJsonp from 'fetch-jsonp';\nimport Home from './panels/Home';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.go = e => {\n      this.setState({\n        activePanel: e.currentTarget.dataset.to\n      });\n    };\n\n    this.state = {\n      activePanel: 'home',\n      fetchedUser: null,\n      authToken: null //items: []\n\n    };\n  }\n\n  componentDidMount() {\n    connect.subscribe(e => {\n      switch (e.detail.type) {\n        case 'VKWebAppGetUserInfoResult':\n          this.setState({\n            fetchedUser: e.detail.data\n          });\n          break;\n\n        case 'VKWebAppAccessTokenReceived':\n          this.setState({\n            authToken: e.detail.data.access_token\n          });\n          this.getItems();\n          break;\n\n        default:\n          console.log(e.detail.type);\n      }\n    });\n    connect.send('VKWebAppGetUserInfo', {});\n    connect.send('VKWebAppGetAuthToken', {\n      'app_id': 6396978,\n      'scope': 'market'\n    });\n  }\n\n  getItems() {\n    const ownerId = 124527492;\n    let api = \"https://api.vk.com/method/market.get?v=5.52&access_token=\".concat(this.state.authToken, \"&owner_id=-\").concat(ownerId);\n    fetchJsonp(api).then(res => res.json()).then(data => this.setState({\n      items: data.response.items\n    })).catch(e => []);\n  }\n\n  render() {\n    return React.createElement(View, {\n      activePanel: this.state.activePanel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, React.createElement(Home, {\n      id: \"home\",\n      items: this.state.items,\n      authToken: this.state.authToken,\n      fetchedUser: this.state.fetchedUser,\n      go: this.go,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["D:/lum3k/Desktop/vkApp/src/App.js"],"names":["React","connect","View","fetchJsonp","Home","App","Component","constructor","props","go","e","setState","activePanel","currentTarget","dataset","to","state","fetchedUser","authToken","componentDidMount","subscribe","detail","type","data","access_token","getItems","console","log","send","ownerId","api","then","res","json","items","response","catch","render"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,SAAQC,IAAR,QAAmB,iBAAnB;AACA,OAAO,+BAAP;AACA,OAAOC,UAAP,MAAuB,aAAvB;AAEA,OAAOC,IAAP,MAAiB,eAAjB;;AAEA,MAAMC,GAAN,SAAkBL,KAAK,CAACM,SAAxB,CAAkC;AAC9BC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SA8BnBC,EA9BmB,GA8BbC,CAAD,IAAO;AACR,WAAKC,QAAL,CAAc;AAACC,QAAAA,WAAW,EAAEF,CAAC,CAACG,aAAF,CAAgBC,OAAhB,CAAwBC;AAAtC,OAAd;AACH,KAhCkB;;AAEf,SAAKC,KAAL,GAAa;AACTJ,MAAAA,WAAW,EAAE,MADJ;AAETK,MAAAA,WAAW,EAAE,IAFJ;AAGTC,MAAAA,SAAS,EAAE,IAHF,CAIT;;AAJS,KAAb;AAOH;;AAGDC,EAAAA,iBAAiB,GAAG;AAChBlB,IAAAA,OAAO,CAACmB,SAAR,CAAmBV,CAAD,IAAO;AACrB,cAAQA,CAAC,CAACW,MAAF,CAASC,IAAjB;AACI,aAAK,2BAAL;AACI,eAAKX,QAAL,CAAc;AAACM,YAAAA,WAAW,EAAEP,CAAC,CAACW,MAAF,CAASE;AAAvB,WAAd;AACA;;AACJ,aAAK,6BAAL;AACI,eAAKZ,QAAL,CAAc;AAACO,YAAAA,SAAS,EAAER,CAAC,CAACW,MAAF,CAASE,IAAT,CAAcC;AAA1B,WAAd;AACA,eAAKC,QAAL;AACA;;AACJ;AACIC,UAAAA,OAAO,CAACC,GAAR,CAAYjB,CAAC,CAACW,MAAF,CAASC,IAArB;AATR;AAWH,KAZD;AAaArB,IAAAA,OAAO,CAAC2B,IAAR,CAAa,qBAAb,EAAoC,EAApC;AACA3B,IAAAA,OAAO,CAAC2B,IAAR,CAAa,sBAAb,EAAqC;AAAC,gBAAU,OAAX;AAAoB,eAAS;AAA7B,KAArC;AACH;;AAMDH,EAAAA,QAAQ,GAAG;AACP,UAAMI,OAAO,GAAG,SAAhB;AACA,QAAIC,GAAG,sEAA+D,KAAKd,KAAL,CAAWE,SAA1E,wBAAiGW,OAAjG,CAAP;AACA1B,IAAAA,UAAU,CAAC2B,GAAD,CAAV,CACCC,IADD,CACMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADb,EAECF,IAFD,CAEMR,IAAI,IAAI,KAAKZ,QAAL,CAAc;AACxBuB,MAAAA,KAAK,EAAEX,IAAI,CAACY,QAAL,CAAcD;AADG,KAAd,CAFd,EAKCE,KALD,CAKO1B,CAAC,IAAI,EALZ;AAMH;;AAED2B,EAAAA,MAAM,GAAG;AACL,WACI,oBAAC,IAAD;AAAM,MAAA,WAAW,EAAE,KAAKrB,KAAL,CAAWJ,WAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,IAAD;AAAM,MAAA,EAAE,EAAC,MAAT;AAAgB,MAAA,KAAK,EAAE,KAAKI,KAAL,CAAWkB,KAAlC;AAAyC,MAAA,SAAS,EAAE,KAAKlB,KAAL,CAAWE,SAA/D;AAA0E,MAAA,WAAW,EAAE,KAAKF,KAAL,CAAWC,WAAlG;AAA+G,MAAA,EAAE,EAAE,KAAKR,EAAxH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ;AAKH;;AApD6B;;AAuDlC,eAAeJ,GAAf","sourcesContent":["import React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport {View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport fetchJsonp from 'fetch-jsonp';\n\nimport Home from './panels/Home';\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            activePanel: 'home',\n            fetchedUser: null,\n            authToken: null,\n            //items: []\n        };\n    \n    }\n    \n        \n    componentDidMount() {\n        connect.subscribe((e) => {\n            switch (e.detail.type) {\n                case 'VKWebAppGetUserInfoResult':\n                    this.setState({fetchedUser: e.detail.data});\n                    break;\n                case 'VKWebAppAccessTokenReceived':\n                    this.setState({authToken: e.detail.data.access_token});\n                    this.getItems()\n                    break;\n                default:\n                    console.log(e.detail.type);\n            }\n        });\n        connect.send('VKWebAppGetUserInfo', {});\n        connect.send('VKWebAppGetAuthToken', {'app_id': 6396978, 'scope': 'market'});\n    }\n    \n    go = (e) => {\n        this.setState({activePanel: e.currentTarget.dataset.to})\n    };\n    \n    getItems() {\n        const ownerId = 124527492\n        let api = `https://api.vk.com/method/market.get?v=5.52&access_token=${this.state.authToken}&owner_id=-${ownerId}`\n        fetchJsonp(api)\n        .then(res => res.json())\n        .then(data => this.setState({\n            items: data.response.items\n        }))\n        .catch(e => [])\n    }\n    \n    render() {\n        return (\n            <View activePanel={this.state.activePanel}>\n                <Home id=\"home\" items={this.state.items} authToken={this.state.authToken} fetchedUser={this.state.fetchedUser} go={this.go}/>\n            </View>\n        );\n    }\n}\n    \nexport default App;"]},"metadata":{},"sourceType":"module"}