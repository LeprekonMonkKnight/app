{"ast":null,"code":"var _jsxFileName = \"D:\\\\lum3k\\\\Desktop\\\\vkApp\\\\src\\\\App.js\";\nimport React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport { View } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Items from './panels/Items';\nimport Item from './panels/Item';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.go = e => {\n      let activePanel = e.currentTarget.dataset.to;\n      this.setState({\n        activePanel: activePanel\n      });\n\n      if (activePanel === 'items') {\n        connect.send(\"VKWebAppSetLocation\", {\n          \"location\": \"items\"\n        });\n        this.getItems();\n      }\n\n      if (activePanel === 'item') {\n        connect.send(\"VKWebAppSetLocation\", {\n          \"location\": 'item${object.itemId}'\n        });\n        this.getInfoItem(object.itemId);\n      }\n    };\n\n    this.state = {\n      activePanel: 'item',\n      fetchedUser: null,\n      authToken: null,\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    connect.subscribe(e => {\n      switch (e.detail.type) {\n        case 'VKWebAppGetUserInfoResult':\n          if (e.detail.data.request_id === \"items\") {\n            this.setState({\n              items: e.detail.data.response.items[0],\n              activePanel: 'item'\n            });\n          }\n\n          break;\n\n        case 'VKWebAppAccessTokenReceived':\n          this.setState({\n            authToken: e.detail.data.access_token\n          });\n          this.getItems();\n          break;\n\n        default:\n          console.log(e.detail.type);\n      }\n    });\n    connect.send('VKWebAppGetUserInfo', {});\n    connect.send('VKWebAppGetAuthToken', {\n      'app_id': 6396978,\n      'scope': 'market'\n    });\n  }\n\n  getItems() {\n    const ownerId = -124527492;\n    connect.send('VKWebAppCallAPIMethod', {\n      \"method\": \"market.get\",\n      \"request_id\": \"items\",\n      \"params\": {\n        \"owner_id\": ownerId,\n        \"v\": \"5.92\",\n        \"access_token\": this.state.authToken\n      }\n    });\n  }\n\n  getInfoItem(id) {\n    const ownerId = -124527492;\n    let itemId = '${ownerId}_${id}';\n    connect.send(\"VKWebAppCallAPIMethod\", {\n      \"method\": \"market.getById\",\n      \"extend\": 1,\n      \"request_id\": \"item\",\n      \"params\": {\n        \"item_ids\": itemId,\n        \"v\": \"5.92\",\n        \"access_token\": this.state.authToken\n      }\n    });\n  }\n\n  getLocationHash() {\n    return winwow.location.hash.replace('#', '');\n  }\n\n  render() {\n    return React.createElement(View, {\n      activePanel: this.state.activePanel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(Items, {\n      id: \"items\",\n      items: this.state.items,\n      go: this.go,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(Item, {\n      id: \"item\",\n      item: this.state.item,\n      go: this.go,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["D:/lum3k/Desktop/vkApp/src/App.js"],"names":["React","connect","View","Items","Item","App","Component","constructor","props","go","e","activePanel","currentTarget","dataset","to","setState","send","getItems","getInfoItem","object","itemId","state","fetchedUser","authToken","items","componentDidMount","subscribe","detail","type","data","request_id","response","access_token","console","log","ownerId","id","getLocationHash","winwow","location","hash","replace","render","item"],"mappings":"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","sourcesContent":["import React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport {View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Items from './panels/Items';\nimport Item from './panels/Item';\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            activePanel: 'item',\n            fetchedUser: null,\n            authToken: null,\n            items: []\n        };\n    \n    }\n    \n        \n    componentDidMount() {\n        connect.subscribe((e) => {\n            switch (e.detail.type) {\n                case 'VKWebAppGetUserInfoResult':\n                    if (e.detail.data.request_id === \"items\") {\n                        this.setState({\n                            items: e.detail.data.response.items[0],\n                            activePanel: 'item'\n                        })\n                    }\n                    break;\n                case 'VKWebAppAccessTokenReceived':\n                    this.setState({authToken: e.detail.data.access_token});\n                    this.getItems()\n                    break;\n                default:\n                    console.log(e.detail.type);\n            }\n        });\n        connect.send('VKWebAppGetUserInfo', {});\n        connect.send('VKWebAppGetAuthToken', {'app_id': 6396978, 'scope': 'market'});\n    }\n    \n    go = (e) => {\n        let activePanel = e.currentTarget.dataset.to\n        this.setState({\n            activePanel: activePanel\n        })\n        if (activePanel === 'items') {\n            connect.send(\"VKWebAppSetLocation\", {\n                \"location\": \"items\"\n            });\n            this.getItems()\n        }\n        if (activePanel === 'item') {\n            connect.send(\"VKWebAppSetLocation\", {\n                \"location\": 'item${object.itemId}'\n            });\n            this.getInfoItem(object.itemId)\n        }\n    };\n    \n    getItems() {\n        const ownerId = -124527492\n        connect.send('VKWebAppCallAPIMethod', {\n            \"method\": \"market.get\",\n            \"request_id\": \"items\",\n            \"params\": {\n                \"owner_id\": ownerId,\n                \"v\": \"5.92\",\n                \"access_token\": this.state.authToken\n            }\n\n        });\n    }\n\n    getInfoItem(id) {\n        const ownerId = -124527492\n        let itemId = '${ownerId}_${id}'\n        connect.send(\"VKWebAppCallAPIMethod\", {\n            \"method\": \"market.getById\",\n            \"extend\": 1,\n            \"request_id\": \"item\",\n            \"params\": {\n                \"item_ids\": itemId,\n                \"v\": \"5.92\",\n                \"access_token\": this.state.authToken\n            }\n        });\n    }\n\n    getLocationHash() {\n        return winwow.location.hash.replace('#', '')\n    }\n    \n    render() {\n        return (\n            <View activePanel={this.state.activePanel}>\n                <Items id=\"items\" items={this.state.items} go={this.go}/>\n                <Item id=\"item\" item={this.state.item} go={this.go} />\n            </View>\n        );\n    }\n}\n    \nexport default App;"]},"metadata":{},"sourceType":"module"}