{"ast":null,"code":"import _slicedToArray from \"D:\\\\lum3k\\\\Desktop\\\\vkApp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\lum3k\\\\Desktop\\\\vkApp\\\\src\\\\App.js\";\nimport React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport { View, ConfigProvider } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Items from './panels/Items';\nimport Item from './panels/Item';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.go = (e, object) => {\n      let activePanel = e.currentTarget.dataset.to;\n      const history = [...this.state.history];\n      history.push(activePanel);\n\n      if (this.state.activePanel === 'items') {\n        connect.send('VKWebAppEnableSwipeBack');\n      }\n\n      this.setState({\n        activePanel: activePanel\n      });\n\n      if (activePanel === 'items') {\n        this.getItems();\n      }\n\n      if (activePanel === 'item') {\n        this.getInfoItem(object.itemId);\n      }\n    };\n\n    this.goBack = () => {\n      const history = [...this.state.history];\n      history.pop();\n      const activePanel = history[history.length - 1];\n\n      if (activePanel === 'items') {\n        connect.send('VKWebAppDisableSwipeBack');\n      }\n\n      this.setState({\n        history,\n        activePanel\n      });\n    };\n\n    this.state = {\n      activePanel: 'items',\n      authToken: null,\n      items: [{\n        \"id\": 250409,\n        \"owner_id\": -124527492,\n        \"title\": \"Persik\",\n        \"description\": \"A majestic furball who adores to sleep, to purr, and to play with a computer mouse.\",\n        \"price\": {\n          \"amount\": \"100000\",\n          \"currency\": {\n            \"id\": 643,\n            \"name\": \"RUB\"\n          },\n          \"text\": \"1,000 rub.\"\n        },\n        \"category\": {\n          \"id\": 1001,\n          \"name\": \"Cats\",\n          \"section\": {\n            \"id\": 10,\n            \"name\": \"Pets\"\n          }\n        },\n        \"date\": 1467722904,\n        \"thumb_photo\": \"https://pp.vk.me/c631229/v631229852/3b6f3/SQ607FYCmy4.jpg\",\n        \"availability\": 0\n      }, {\n        \"id\": 250407,\n        \"owner_id\": -124527492,\n        \"title\": \"Spotty\",\n        \"description\": \"A tail wagging champion, true friend and never-failing warmer.\",\n        \"price\": {\n          \"amount\": \"100000\",\n          \"currency\": {\n            \"id\": 643,\n            \"name\": \"RUB\"\n          },\n          \"text\": \"1,000 rub.\"\n        },\n        \"category\": {\n          \"id\": 1000,\n          \"name\": \"Dogs\",\n          \"section\": {\n            \"id\": 10,\n            \"name\": \"Pets\"\n          }\n        },\n        \"date\": 1467722851,\n        \"thumb_photo\": \"https://pp.vk.me/c631229/v631229852/3b6e5/1OWGz65-8vw.jpg\",\n        \"availability\": 0\n      }, {\n        \"id\": 250396,\n        \"owner_id\": -124527492,\n        \"title\": \"First market item\",\n        \"description\": \"Description text\",\n        \"price\": {\n          \"amount\": \"10000\",\n          \"currency\": {\n            \"id\": 643,\n            \"name\": \"RUB\"\n          },\n          \"text\": \"100 rub.\"\n        },\n        \"category\": {\n          \"id\": 1,\n          \"name\": \"Women's Clothing\",\n          \"section\": {\n            \"id\": 0,\n            \"name\": \"Fashion\"\n          }\n        },\n        \"date\": 1467721947,\n        \"thumb_photo\": \"https://pp.vk.me/c633819/v633819852/37ae0/7lXUEbCwYYM.jpg\",\n        \"availability\": 0\n      }],\n      item: null,\n      history: ['items']\n    };\n  }\n\n  getLocationHash() {\n    return window.location.hash.replace('#', '');\n  }\n\n  getObjectUrlString(string) {\n    let search = string;\n    let objectUrl = search === \"\" ? null : search.split(\"&\").reduce((prev, curr) => {\n      const _curr$split = curr.split(\"=\"),\n            _curr$split2 = _slicedToArray(_curr$split, 2),\n            key = _curr$split2[0],\n            value = _curr$split2[1];\n\n      prev[decodeURIComponent(key)] = decodeURIComponent(value);\n      return prev;\n    }, {});\n    return objectUrl;\n  }\n\n  getActivePanelRenderString() {\n    const stringHash = this.getLocationHash();\n    const objectParametrs = this.getObjectUrlString(stringHash);\n    let renderStringActivePanel = 'items';\n\n    if (objectParametrs !== null && typeof objectParametrs.itemId !== 'undefined') {\n      renderStringActivePanel = 'item';\n    }\n\n    return renderStringActivePanel;\n  }\n\n  componentWillMount() {\n    connect.subscribe(e => {\n      switch (e.detail.type) {\n        case 'VKWebAppAccessTokenReceived':\n          this.setState({\n            authToken: e.detail.data.access_token\n          }, () => {\n            const stringActivePanel = this.getActivePanelRenderString();\n\n            if (stringActivePanel === 'items') {\n              this.setState({\n                activePanel: 'items'\n              }, () => {\n                this.getItems();\n              });\n            } else if (stringActivePanel.indexOf('item') !== -1) {\n              const stringHash = this.getLocationHash();\n              const objectParametrs = this.getObjectUrlString(stringHash);\n              const id = objectParametrs.itemId;\n              this.setState({\n                activePanel: 'item'\n              }, () => {\n                this.getInfoItem(id);\n              });\n            } else {\n              this.setState({\n                activePanel: 'items'\n              }, () => {\n                this.getItems();\n              });\n            }\n          });\n          break;\n\n        case 'VKWebAppCallAPIMethodResult':\n          if (e.detail.data.request_id === \"items\") {\n            this.setState({\n              items: e.detail.data.response.items\n            });\n          }\n\n          if (e.detail.data.request_id === \"item\") {\n            this.setState({\n              item: e.detail.data.response.items[0]\n            });\n          }\n\n          break;\n\n        default:\n          console.log(e.detail);\n      }\n    });\n    connect.send(\"VKWebAppGetAuthToken\", {\n      \"app_id\": 6906999,\n      \"scope\": \"market\"\n    });\n  }\n\n  getItems() {\n    const ownerId = -124527492;\n    connect.send(\"VKWebAppCallAPIMethod\", {\n      \"method\": \"market.get\",\n      \"request_id\": \"items\",\n      \"params\": {\n        \"owner_id\": ownerId,\n        \"v\": \"5.92\",\n        \"access_token\": this.state.authToken\n      }\n    });\n  }\n\n  getInfoItem(id) {\n    const ownerId = -124527492;\n    let itemId = \"\".concat(ownerId, \"_\").concat(id);\n    connect.send(\"VKWebAppCallAPIMethod\", {\n      \"method\": \"market.getById\",\n      \"request_id\": \"item\",\n      \"params\": {\n        \"item_ids\": itemId,\n        \"v\": \"5.92\",\n        \"extended\": 1,\n        \"access_token\": this.state.authToken\n      }\n    });\n  }\n\n  render() {\n    return React.createElement(ConfigProvider, {\n      isWebView: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(View, {\n      onSwipeBack: this.goBack,\n      history: this.state.history,\n      activePanel: this.state.activePanel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(Items, {\n      id: \"items\",\n      items: this.state.items,\n      go: this.go,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }), React.createElement(Item, {\n      id: \"item\",\n      item: this.state.item,\n      go: this.go,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["D:/lum3k/Desktop/vkApp/src/App.js"],"names":["React","connect","View","ConfigProvider","Items","Item","App","Component","constructor","props","go","e","object","activePanel","currentTarget","dataset","to","history","state","push","send","setState","getItems","getInfoItem","itemId","goBack","pop","length","authToken","items","item","getLocationHash","window","location","hash","replace","getObjectUrlString","string","search","objectUrl","split","reduce","prev","curr","key","value","decodeURIComponent","getActivePanelRenderString","stringHash","objectParametrs","renderStringActivePanel","componentWillMount","subscribe","detail","type","data","access_token","stringActivePanel","indexOf","id","request_id","response","console","log","ownerId","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport { View, ConfigProvider } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Items from './panels/Items';\nimport Item from './panels/Item';\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactivePanel : 'items',\n\t\t\tauthToken : null,\n\t\t\titems : [\n\t\t\t\t{\n                    \"id\": 250409,\n                    \"owner_id\": -124527492,\n                    \"title\": \"Persik\",\n                    \"description\": \"A majestic furball who adores to sleep, to purr, and to play with a computer mouse.\",\n                    \"price\": {\n                        \"amount\": \"100000\",\n                        \"currency\": {\n                            \"id\": 643,\n                            \"name\": \"RUB\"\n                        },\n                        \"text\": \"1,000 rub.\"\n                    },\n                    \"category\": {\n                        \"id\": 1001,\n                        \"name\": \"Cats\",\n                        \"section\": {\n                            \"id\": 10,\n                            \"name\": \"Pets\"\n                        }\n                    },\n                    \"date\": 1467722904,\n                    \"thumb_photo\": \"https://pp.vk.me/c631229/v631229852/3b6f3/SQ607FYCmy4.jpg\",\n                    \"availability\": 0\n                },\n                {\n                    \"id\": 250407,\n                    \"owner_id\": -124527492,\n                    \"title\": \"Spotty\",\n                    \"description\": \"A tail wagging champion, true friend and never-failing warmer.\",\n                    \"price\": {\n                        \"amount\": \"100000\",\n                        \"currency\": {\n                            \"id\": 643,\n                            \"name\": \"RUB\"\n                        },\n                        \"text\": \"1,000 rub.\"\n                    },\n                    \"category\": {\n                        \"id\": 1000,\n                        \"name\": \"Dogs\",\n                        \"section\": {\n                            \"id\": 10,\n                            \"name\": \"Pets\"\n                        }\n                    },\n                    \"date\": 1467722851,\n                    \"thumb_photo\": \"https://pp.vk.me/c631229/v631229852/3b6e5/1OWGz65-8vw.jpg\",\n                    \"availability\": 0\n                },\n                {\n                    \"id\": 250396,\n                    \"owner_id\": -124527492,\n                    \"title\": \"First market item\",\n                    \"description\": \"Description text\",\n                    \"price\": {\n                        \"amount\": \"10000\",\n                        \"currency\": {\n                            \"id\": 643,\n                            \"name\": \"RUB\"\n                        },\n                        \"text\": \"100 rub.\"\n                    },\n                    \"category\": {\n                        \"id\": 1,\n                        \"name\": \"Women's Clothing\",\n                        \"section\": {\n                            \"id\": 0,\n                            \"name\": \"Fashion\"\n                        }\n                    },\n                    \"date\": 1467721947,\n                    \"thumb_photo\": \"https://pp.vk.me/c633819/v633819852/37ae0/7lXUEbCwYYM.jpg\",\n                    \"availability\": 0\n                }\n\t\t\t],\n\t\t\titem : null,\n\t\t\thistory: ['items']\n\t\t};\n\t}\n\n\tgetLocationHash() {\n\t\treturn window.location.hash.replace('#','')\n\t}\n\n\tgetObjectUrlString(string) {\n\t\tlet search = string\n\t\tlet objectUrl = search === \"\" ? null : search.split(\"&\").reduce((prev, curr) => {\n\t\t\tconst [key, value] = curr.split(\"=\");\n\t\t\tprev[decodeURIComponent(key)] = decodeURIComponent(value);\n\t\t\treturn prev;\n\t\t}, {});\n\t\treturn objectUrl\n\t}\n\n\tgetActivePanelRenderString() {\n\t\tconst stringHash = this.getLocationHash()\n\t\tconst objectParametrs = this.getObjectUrlString(stringHash)\n\t\tlet renderStringActivePanel = 'items'\n\n\t\tif (objectParametrs !== null && typeof objectParametrs.itemId !== 'undefined') {\n\t\t\trenderStringActivePanel = 'item'\n\t\t}\n\t\treturn renderStringActivePanel\n\t}\n\n\tcomponentWillMount() {\n\t\tconnect.subscribe((e) => {\n\t\t\tswitch (e.detail.type) {\n\t\t\t\tcase 'VKWebAppAccessTokenReceived':\n\t\t\t\t\tthis.setState({ authToken : e.detail.data.access_token }, () =>{\n\t\t\t\t\t\tconst stringActivePanel = this.getActivePanelRenderString()\n\t\t\t\t\t\tif (stringActivePanel === 'items') {\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tactivePanel: 'items'\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tthis.getItems()\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else if (stringActivePanel.indexOf('item') !== -1) {\n\t\t\t\t\t\t\tconst stringHash = this.getLocationHash()\n\t\t\t\t\t\t\tconst objectParametrs = this.getObjectUrlString(stringHash)\n\t\t\t\t\t\t\tconst id = objectParametrs.itemId\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tactivePanel: 'item'\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tthis.getInfoItem(id)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tactivePanel: 'items'\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tthis.getItems()\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'VKWebAppCallAPIMethodResult':\n\t\t\t\t\tif (e.detail.data.request_id === \"items\") {\n\t\t\t\t\t\tthis.setState({ items : e.detail.data.response.items })\n\t\t\t\t\t}\n\t\t\t\t\tif (e.detail.data.request_id === \"item\") {\n\t\t\t\t\t\tthis.setState({ item : e.detail.data.response.items[0] })\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(e.detail);\n\t\t\t}\n\t\t});\n\t\tconnect.send(\"VKWebAppGetAuthToken\", {\"app_id\": 6906999, \"scope\": \"market\"});\n\t}\n\n\tgetItems() {\n\t\tconst ownerId = -124527492\n\t\tconnect.send(\"VKWebAppCallAPIMethod\", {\"method\": \"market.get\", \"request_id\" : \"items\", \"params\": {\"owner_id\": ownerId , \"v\":\"5.92\", \"access_token\": this.state.authToken }});\n\t}\n\n\tgetInfoItem(id) {\n\t\tconst ownerId = -124527492\n\t\tlet itemId = `${ownerId}_${id}`\n\t\tconnect.send(\"VKWebAppCallAPIMethod\", {\"method\": \"market.getById\", \"request_id\" : \"item\",  \"params\": {\"item_ids\": itemId , \"v\":\"5.92\", \"extended\" : 1,  \"access_token\": this.state.authToken }});\n\t}\n\n\tgo = (e, object) => {\n\t\tlet activePanel = e.currentTarget.dataset.to\n\t\tconst history = [...this.state.history];\n\t\thistory.push(activePanel);\n\t\tif (this.state.activePanel === 'items') {\n\t\t\tconnect.send('VKWebAppEnableSwipeBack');\n\t\t}\n\t\tthis.setState({ activePanel : activePanel })\n\t\tif (activePanel === 'items') {\n\t\t\tthis.getItems()\n\t\t}\n\t\tif (activePanel === 'item') {\n\t\t\tthis.getInfoItem(object.itemId)\n\t\t}\n\t}\n\n\tgoBack = () => {\n\t\tconst history = [...this.state.history];\n\t\thistory.pop();\n\t\tconst activePanel = history[history.length - 1];\n\t\tif (activePanel === 'items') {\n\t\t\tconnect.send('VKWebAppDisableSwipeBack');\n\t\t}\n\t\tthis.setState({ history, activePanel});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<ConfigProvider isWebView={true}>\n\t\t\t\t<View \n\t\t\t\t\tonSwipeBack={this.goBack}\n\t\t\t\t\thistory={this.state.history}\n\t\t\t\t\tactivePanel={this.state.activePanel}>\n\t\t\t\t\t<Items \n\t\t\t\t\t\tid=\"items\" \n\t\t\t\t\t\titems={this.state.items}\n\t\t\t\t\t\tgo={this.go}\n\t\t\t\t\t/>\n\t\t\t\t\t<Item \n\t\t\t\t\t\tid=\"item\"\n\t\t\t\t\t\titem={this.state.item}\n\t\t\t\t\t\tgo={this.go}\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</ConfigProvider>\n\t\t);\n\t}\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}